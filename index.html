<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LearnEnglish for Developers ‚Äî dev.to + Work English</title>
<meta name="theme-color" content="#0b1220" />
<style>
  :root{
    --bg:#0b1220; --panel:#121a2b; --card:#16233a; --muted:#90a3b3; --text:#e7eef6;
    --accent:#6fd1ff; --border:#20304e; --soft:#253a5d; --chip:#0e1a2e; --good:#2ecc71; --bad:#ff5d5d;
  }
  body.light{
    --bg:#ffffff; --panel:#ffffffee; --card:#f7f9ff; --muted:#5b6570; --text:#0e1320;
    --accent:#0077ff; --border:#e6e8ee; --soft:#eef0f5; --chip:#f4f6fb; --good:#15a34a; --bad:#e11d48;
  }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,var(--bg),var(--bg) 60%,#0e1628);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
  body.light{background:linear-gradient(180deg,#f7f9fc,#fff 60%,#f7f9fc)}
  .wrap{max-width:1100px;margin:0 auto;padding:16px}
  header{position:sticky;top:0;background:var(--panel);backdrop-filter:blur(8px);border-bottom:1px solid var(--border);z-index:10}
  h1{margin:8px 0 2px;font-size:22px}
  .sub{color:var(--muted);font-size:13px}
  .grid{display:grid;grid-template-columns:2fr 1fr;gap:12px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:0 8px 24px rgba(0,0,0,.2)}
  .toolbar{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
  select,button,input{border:1px solid var(--border);border-radius:12px;background:#0f1b2f;color:var(--text);padding:10px 12px;font-size:14px}
  body.light select,body.light button,body.light input{background:#fff}
  button{cursor:pointer;transition:.15s ease}
  button:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.25)}
  .segment{display:inline-flex;background:var(--chip);border:1px solid var(--soft);border-radius:999px;padding:4px;gap:4px}
  .segment input{position:absolute;opacity:0}
  .segment label{padding:6px 10px;border-radius:999px;font-size:12px;color:var(--muted);cursor:pointer;border:1px solid transparent}
  .segment input:checked+label{color:var(--text);background:var(--card);border-color:var(--soft);box-shadow:0 2px 8px rgba(0,0,0,.08);transform:translateY(-1px)}
  .kpi{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  .pill{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:999px;background:var(--chip);border:1px solid var(--soft);color:var(--muted);font-size:12px}
  .pill strong{color:var(--text)}
  .tabs{display:flex;gap:6px;margin-top:8px}
  .tab{padding:8px 10px;border:1px solid var(--border);border-radius:10px;background:#0f1b2f}
  .active{outline:2px solid var(--accent)}
  .fc{font-size:48px;text-align:center;margin:16px 0;word-break:break-word}
  .big{font-size:20px}
  .small{font-size:12px;color:var(--muted)}
  .choices{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:12px}
  .choice{padding:12px;border-radius:12px;border:1px solid #2a3c60;background:#0f1930;cursor:pointer}
  .choice.correct{border-color:#246b47;background:#122b21}
  .choice.wrong{border-color:#6b2424;background:#2b1212}
  body.light .choice{background:#fff;border-color:var(--border)}
  body.light .choice.correct{background:#e7f7ee;border-color:#bae8cc}
  body.light .choice.wrong{background:#ffefef;border-color:#ffd2cf}
  .summary{background:var(--chip);border:1px solid var(--soft);border-radius:12px;padding:12px}
  .table{width:100%;border-collapse:collapse}
  .table th,.table td{font-size:12px;border-bottom:1px solid var(--soft);padding:6px 8px;text-align:left}
  .list{max-height:240px;overflow:auto;border:1px solid var(--soft);border-radius:12px;padding:8px;margin-top:10px}
  .tag{display:block;padding:8px 10px;border:1px solid var(--soft);border-radius:10px;margin-bottom:6px}
  .tag.known{opacity:.7;text-decoration:line-through}
  .spark{display:flex;gap:2px;align-items:flex-end;height:40px}
  .bar{flex:1;background:linear-gradient(180deg,var(--accent),transparent);border-radius:3px}
  .goodtxt{color:var(--good)} .badtxt{color:var(--bad)}
  footer.site{background:var(--panel);border-top:1px solid var(--border);backdrop-filter:blur(8px);padding:14px 0;color:var(--muted);font-size:13px;margin-top:10px}
  .site .inner{max-width:1100px;margin:0 auto;padding:0 16px;display:flex;align-items:center;justify-content:space-between}
  @media(max-width:980px){.grid{grid-template-columns:1fr}.choices{grid-template-columns:1fr}}
</style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>LearnEnglish for Developers</h1>
      <div class="sub">Pakiety: <strong>dev.to English</strong> + <strong>Workplace English</strong> (+ Python/GitHub/QA). Fiszki, Quiz ABCD, historia i statystyki.</div>
    </div>
  </header>

  <main class="wrap" style="padding-top:12px">
    <div class="grid">
      <section class="card">
        <div class="toolbar">
          <!-- Pakiety z ikonƒÖ i opisem -->
          <select id="package" title="Wybierz pakiet"></select>

          <!-- Motyw -->
          <div class="segment" role="tablist" aria-label="Motyw">
            <input type="radio" name="theme" id="t-light" value="light"><label for="t-light">‚òÄÔ∏è Jasny</label>
            <input type="radio" name="theme" id="t-dark"  value="dark"><label for="t-dark">üåô Ciemny</label>
          </div>

          <!-- Tryby -->
          <div class="tabs" role="tablist">
            <button class="tab active" id="tab-flash">Fiszki</button>
            <button class="tab" id="tab-quiz">Quiz ABCD</button>
            <button class="tab" id="tab-stats">Statystyki</button>
          </div>

          <button id="shuffle">Wymieszaj</button>
          <button id="reset">Zeruj postƒôp</button>
        </div>

        <!-- KPI -->
        <div class="kpi" aria-live="polite">
          <div class="pill">Nauczone: <strong id="k-known">0</strong></div>
          <div class="pill">Do nauki: <strong id="k-left">0</strong></div>
          <div class="pill">Skuteczno≈õƒá (quiz): <strong id="k-acc">0%</strong></div>
          <div class="pill">Sesje (7 dni): <strong id="k-week">0</strong></div>
        </div>

        <!-- FISZKI -->
        <div id="view-flash">
          <div class="fc" id="card-word">‚Äî</div>
          <div class="big" id="card-translation" style="min-height:28px">&nbsp;</div>
          <div class="small" id="card-example" style="min-height:18px">&nbsp;</div>
          <div class="toolbar" style="margin-top:8px">
            <select id="direction" title="Kierunek">
              <option value="EN2PL">EN ‚Üí PL</option>
              <option value="PL2EN">PL ‚Üí EN</option>
              <option value="MIX">MIX</option>
            </select>
            <button id="show">Poka≈º t≈Çumaczenie</button>
            <button id="hint">Poka≈º wskaz√≥wkƒô</button>
            <button id="know" style="border-color:#1f5f3a;background:#123022">Znam to</button>
            <button id="next">Dalej</button>
          </div>
        </div>

        <!-- QUIZ -->
        <div id="view-quiz" class="summary" style="display:none">
          <div class="big" id="quiz-q">&nbsp;</div>
          <div class="choices" id="quiz-choices"></div>
          <div class="small" id="quiz-feedback" style="margin-top:8px" aria-live="polite"></div>
          <div class="small" id="quiz-progress" style="margin-top:4px"></div>
          <div class="toolbar" style="margin-top:8px">
            <button id="quiz-next">Nastƒôpne pytanie</button>
            <button id="quiz-10">Seria 10 pyta≈Ñ</button>
            <button id="quiz-20">Seria 20 pyta≈Ñ</button>
          </div>
        </div>

        <!-- STATYSTYKI -->
        <div id="view-stats" style="display:none">
          <div class="section-title small">Podsumowanie</div>
          <div class="summary" id="stats-summary"></div>

          <div class="section-title small" style="margin-top:10px">Aktywno≈õƒá: ostatnie 7 dni</div>
          <div id="spark" class="spark"></div>

          <div class="section-title small" style="margin-top:10px">Historia sesji (ostatnie 30)</div>
          <div id="history"></div>
        </div>
      </section>

      <aside class="card">
        <h3 style="margin:0">S≈Çownik pakietu</h3>
        <div id="tags"></div>
        <div id="list" class="list"></div>
        <div class="small" style="margin-top:6px">Kliknij s≈Çowo, aby oznaczyƒá/odznaczyƒá jako nauczone.</div>
      </aside>
    </div>
  </main>

  <footer class="site">
    <div class="inner">
      <div>¬© 2025 LearnEnglish for Developers ‚Äî dev.to + Work English</div>
      <div>Autor: <a href="https://github.com/zolwikC" target="_blank" rel="noopener">zolwikC</a></div>
    </div>
  </footer>

<script>
/* ===================== PAKIETY (rozszerzone) ===================== */
/* Struktura elementu:
   { en:"...", pl:"...", tag:"...", exEN:"(opcjonalne zdanie)", exPL:"(t≈Çumaczenie)" } */
const packages = {
  devto_general:{
    icon:"üí¨",
    name:"English for dev.to",
    desc:"czytanie, komentarze, pisanie post√≥w",
    words:[
      // Core czytanie/komentarze
      {en:"developer",pl:"programista",tag:"core"},
      {en:"software engineer",pl:"in≈ºynier oprogramowania",tag:"core"},
      {en:"open source",pl:"otwarte oprogramowanie",tag:"core"},
      {en:"repository",pl:"repozytorium",tag:"core"},
      {en:"maintainer",pl:"opiekun projektu",tag:"core"},
      {en:"pull request",pl:"pro≈õba o scalenie",tag:"core"},
      {en:"merge conflict",pl:"konflikt scalania",tag:"core"},
      {en:"issue",pl:"zg≈Çoszenie/problem",tag:"core"},
      {en:"commit",pl:"zatwierdzenie zmian",tag:"core"},
      {en:"branch",pl:"ga≈ÇƒÖ≈∫ (kodu)",tag:"core"},
      {en:"release",pl:"wydanie",tag:"core"},
      {en:"workflow",pl:"przep≈Çyw pracy",tag:"core"},
      {en:"roadmap",pl:"plan rozwoju",tag:"core"},
      {en:"contribute",pl:"wnosiƒá wk≈Çad",tag:"core"},
      {en:"review",pl:"recenzja / przeglƒÖd",tag:"core"},
      {en:"documentation",pl:"dokumentacja",tag:"core"},
      {en:"tutorial",pl:"poradnik",tag:"core"},
      {en:"walkthrough",pl:"krok po kroku",tag:"core"},
      {en:"benchmark",pl:"test wydajno≈õci",tag:"core"},
      {en:"performance",pl:"wydajno≈õƒá",tag:"core"},
      {en:"scalability",pl:"skalowalno≈õƒá",tag:"core"},
      {en:"trade-off",pl:"kompromis",tag:"core"},
      {en:"use case",pl:"przypadek u≈ºycia",tag:"core"},
      {en:"best practices",pl:"dobre praktyki",tag:"core"},
      {en:"anti-pattern",pl:"antywzorzec",tag:"core"},
      // Pytania/komentarze
      {en:"Great post!",pl:"≈öwietny wpis!",tag:"comments"},
      {en:"Thanks for sharing.",pl:"Dziƒôki za podzielenie siƒô.",tag:"comments"},
      {en:"I learned a lot from this.",pl:"Du≈ºo siƒô z tego nauczy≈Çem.",tag:"comments"},
      {en:"Could you provide an example?",pl:"Czy m√≥g≈Çby≈õ podaƒá przyk≈Çad?",tag:"comments"},
      {en:"I faced the same issue.",pl:"Mia≈Çem ten sam problem.",tag:"comments"},
      {en:"Here‚Äôs my solution.",pl:"Oto moje rozwiƒÖzanie.",tag:"comments"},
      {en:"This helped me a lot.",pl:"To bardzo mi pomog≈Ço.",tag:"comments"},
      {en:"Nice explanation!",pl:"≈öwietne wyja≈õnienie!",tag:"comments"},
      {en:"I disagree, because...",pl:"Nie zgadzam siƒô, poniewa≈º...",tag:"comments"},
      // Pisanie artyku≈Ç√≥w
      {en:"In this tutorial, we‚Äôll learn how to...",pl:"W tym poradniku nauczymy siƒô, jak...",tag:"writing"},
      {en:"Let‚Äôs take a look at...",pl:"Przyjrzyjmy siƒô...",tag:"writing"},
      {en:"Make sure you have installed...",pl:"Upewnij siƒô, ≈ºe masz zainstalowane...",tag:"writing"},
      {en:"This approach allows us to...",pl:"To podej≈õcie pozwala nam...",tag:"writing"},
      {en:"Run the following command:",pl:"Uruchom nastƒôpujƒÖcƒÖ komendƒô:",tag:"writing"},
      {en:"Keep in mind that...",pl:"Pamiƒôtaj, ≈ºe...",tag:"writing"},
      {en:"It‚Äôs important to note that...",pl:"Warto zauwa≈ºyƒá, ≈ºe...",tag:"writing"},
      {en:"This project is built with...",pl:"Ten projekt zbudowano przy u≈ºyciu...",tag:"writing"},
      {en:"You can customize this by...",pl:"Mo≈ºesz to dostosowaƒá poprzez...",tag:"writing"},
      {en:"Let‚Äôs refactor our code.",pl:"Przebudujmy nasz kod.",tag:"writing"},
      // Zdania (typowe na dev.to)
      {en:"I‚Äôm currently learning React and Flask.",pl:"Aktualnie uczƒô siƒô Reacta i Flaska.",tag:"sentences"},
      {en:"This article helped me fix a deployment issue.",pl:"Ten artyku≈Ç pom√≥g≈Ç mi naprawiƒá problem z wdro≈ºeniem.",tag:"sentences"},
      {en:"You can find the source code on GitHub.",pl:"Kod ≈∫r√≥d≈Çowy znajdziesz na GitHubie.",tag:"sentences"},
      {en:"I wrote a similar post about API authentication.",pl:"Napisa≈Çem podobny wpis o uwierzytelnianiu API.",tag:"sentences"},
      {en:"If you encounter any errors, check the logs.",pl:"Je≈õli napotkasz b≈Çƒôdy, sprawd≈∫ logi.",tag:"sentences"},
      {en:"This project follows the MVC pattern.",pl:"Ten projekt korzysta z wzorca MVC.",tag:"sentences"},
      {en:"Let‚Äôs fix this bug together.",pl:"Naprawmy ten b≈ÇƒÖd razem.",tag:"sentences"},
      {en:"The new feature works perfectly.",pl:"Nowa funkcja dzia≈Ça znakomicie.",tag:"sentences"},
      {en:"What stack are you using for your app?",pl:"Jakiego stosu technologicznego u≈ºywasz?",tag:"sentences"},
      {en:"Can you recommend resources for beginners?",pl:"Polecisz materia≈Çy dla poczƒÖtkujƒÖcych?",tag:"sentences"},
      {en:"I deployed the app to Render successfully.",pl:"Pomy≈õlnie wdro≈ºy≈Çem aplikacjƒô na Render.",tag:"sentences"},
      {en:"The code looks clean and well-structured.",pl:"Kod wyglƒÖda czysto i jest dobrze zorganizowany.",tag:"sentences"},
      {en:"I need to optimize the performance of this script.",pl:"Muszƒô zoptymalizowaƒá wydajno≈õƒá tego skryptu.",tag:"sentences"},
      {en:"Let‚Äôs deploy the final version today.",pl:"Wdr√≥≈ºmy dzi≈õ ostatecznƒÖ wersjƒô.",tag:"sentences"}
    ]
  },

  meetings_teamwork:{
    icon:"üó£Ô∏è",
    name:"Workplace English",
    desc:"rozmowy w pracy i codzienna komunikacja",
    words:[
      {en:"Let‚Äôs discuss this later.",pl:"Om√≥wmy to p√≥≈∫niej.",tag:"meeting"},
      {en:"I agree with your point.",pl:"Zgadzam siƒô z TobƒÖ.",tag:"meeting"},
      {en:"Could you clarify that?",pl:"Czy mo≈ºesz to doprecyzowaƒá?",tag:"meeting"},
      {en:"We need to prioritize tasks.",pl:"Musimy ustaliƒá priorytety zada≈Ñ.",tag:"team"},
      {en:"Our deadline is next week.",pl:"Termin jest w przysz≈Çym tygodniu.",tag:"team"},
      {en:"Let‚Äôs assign responsibilities.",pl:"Przydzielmy obowiƒÖzki.",tag:"team"},
      {en:"We‚Äôre making good progress.",pl:"Robimy dobre postƒôpy.",tag:"team"},
      {en:"I‚Äôll handle this issue.",pl:"Zajmƒô siƒô tym problemem.",tag:"team"},
      {en:"Can you take a look at this bug?",pl:"Mo≈ºesz zerknƒÖƒá na ten b≈ÇƒÖd?",tag:"team"},
      {en:"Let‚Äôs keep communication open.",pl:"Utrzymujmy otwartƒÖ komunikacjƒô.",tag:"team"},
      {en:"I‚Äôm running a bit late.",pl:"Trochƒô siƒô sp√≥≈∫niƒô.",tag:"daily"},
      {en:"I‚Äôm on it.",pl:"Ju≈º siƒô tym zajmujƒô.",tag:"daily"},
      {en:"Sounds good to me.",pl:"Brzmi dobrze.",tag:"daily"},
      {en:"That works for me.",pl:"To mi pasuje.",tag:"daily"},
      {en:"Let‚Äôs touch base tomorrow.",pl:"Skontaktujmy siƒô jutro.",tag:"daily"},
      // Zdania sytuacyjne
      {en:"Could you share your screen?",pl:"Czy mo≈ºesz udostƒôpniƒá ekran?",tag:"sentences"},
      {en:"Let‚Äôs take five and continue at ten past.",pl:"Zr√≥bmy piƒôƒá minut przerwy i wr√≥ƒámy za dziesiƒôƒá po.",tag:"sentences"},
      {en:"I‚Äôll write a short summary after the meeting.",pl:"Napiszƒô kr√≥tkie podsumowanie po spotkaniu.",tag:"sentences"},
      {en:"Please keep your comments brief.",pl:"Proszƒô, m√≥wcie kr√≥tko.",tag:"sentences"},
      {en:"We should loop in the product owner.",pl:"Powinni≈õmy do≈ÇƒÖczyƒá product ownera.",tag:"sentences"}
    ]
  },

  python_flask:{
    icon:"üêç",
    name:"Python & Flask",
    desc:"s≈Çownictwo backend/Flask",
    words:[
      {en:"route",pl:"≈õcie≈ºka w aplikacji",tag:"flask"},
      {en:"endpoint",pl:"punkt ko≈Ñcowy API",tag:"flask"},
      {en:"template",pl:"szablon HTML",tag:"flask"},
      {en:"render",pl:"wyrenderowaƒá",tag:"flask"},
      {en:"context",pl:"kontekst danych",tag:"flask"},
      {en:"debug mode",pl:"tryb debugowania",tag:"python"},
      {en:"exception",pl:"wyjƒÖtek",tag:"python"},
      {en:"traceback",pl:"≈õlad b≈Çƒôdu (traceback)",tag:"python"},
      {en:"decorator",pl:"dekorator",tag:"python"},
      {en:"dictionary",pl:"s≈Çownik (typ danych)",tag:"python"},
      {en:"inheritance",pl:"dziedziczenie",tag:"python"},
      // Zdania
      {en:"The route returns a JSON response.",pl:"Ta ≈õcie≈ºka zwraca odpowied≈∫ JSON.",tag:"sentences"},
      {en:"Check the logs to see the traceback.",pl:"Sprawd≈∫ logi, aby zobaczyƒá traceback.",tag:"sentences"},
      {en:"We render the template with context variables.",pl:"Renderujemy szablon z zmiennymi kontekstu.",tag:"sentences"}
    ]
  },

  github_workflow:{
    icon:"üêô",
    name:"GitHub Workflow",
    desc:"git, PR, code review",
    words:[
      {en:"commit message",pl:"wiadomo≈õƒá commita",tag:"git"},
      {en:"branch",pl:"ga≈ÇƒÖ≈∫ kodu",tag:"git"},
      {en:"merge request / pull request",pl:"pro≈õba o scalenie",tag:"git"},
      {en:"conflict",pl:"konflikt w kodzie",tag:"git"},
      {en:"push changes",pl:"wypchnƒÖƒá zmiany",tag:"git"},
      {en:"revert",pl:"cofnƒÖƒá zmiany",tag:"git"},
      {en:"review comments",pl:"uwagi z przeglƒÖdu",tag:"git"},
      {en:"squash commits",pl:"sp≈Çaszczyƒá commity",tag:"git"},
      // Zdania
      {en:"Please resolve conflicts before merging.",pl:"Proszƒô rozwiƒÖzaƒá konflikty przed scaleniem.",tag:"sentences"},
      {en:"Could you add tests to this PR?",pl:"Czy mo≈ºesz dodaƒá testy do tego PR-a?",tag:"sentences"}
    ]
  },

  qa_testing:{
    icon:"üß™",
    name:"QA & Testing",
    desc:"ISTQB, raportowanie b≈Çƒôd√≥w",
    words:[
      {en:"test case",pl:"przypadek testowy",tag:"qa"},
      {en:"test plan",pl:"plan test√≥w",tag:"qa"},
      {en:"test suite",pl:"zestaw test√≥w",tag:"qa"},
      {en:"bug report",pl:"raport b≈Çƒôdu",tag:"qa"},
      {en:"expected result",pl:"oczekiwany wynik",tag:"qa"},
      {en:"actual result",pl:"rzeczywisty wynik",tag:"qa"},
      {en:"severity",pl:"waga b≈Çƒôdu",tag:"qa"},
      {en:"priority",pl:"priorytet",tag:"qa"},
      {en:"regression testing",pl:"testy regresyjne",tag:"qa"},
      {en:"acceptance criteria",pl:"kryteria akceptacji",tag:"qa"},
      // Zdania
      {en:"The bug is reproducible with the following steps.",pl:"B≈ÇƒÖd jest odtwarzalny przy poni≈ºszych krokach.",tag:"sentences"},
      {en:"The fix passed all regression tests.",pl:"Poprawka przesz≈Ça wszystkie testy regresyjne.",tag:"sentences"}
    ]
  },

  devto_300: {
  icon: "üöÄ",
  name: "English for Developers ‚Äî 300 essentials",
  desc: "pe≈Çny pakiet dev.to + praca zespo≈Çowa + komunikacja w IT",
  words: [
    // === CORE TECH VOCABULARY ===
    { en: "software", pl: "oprogramowanie" },
    { en: "hardware", pl: "sprzƒôt komputerowy" },
    { en: "framework", pl: "struktura programistyczna" },
    { en: "library", pl: "biblioteka (kod)" },
    { en: "package manager", pl: "mened≈ºer pakiet√≥w" },
    { en: "dependency", pl: "zale≈ºno≈õƒá (pakiet)" },
    { en: "repository", pl: "repozytorium" },
    { en: "branch", pl: "ga≈ÇƒÖ≈∫ kodu" },
    { en: "commit", pl: "zatwierdzenie zmian" },
    { en: "merge", pl: "scalenie kodu" },
    { en: "pull request", pl: "pro≈õba o scalenie" },
    { en: "push changes", pl: "wypchnƒÖƒá zmiany" },
    { en: "version control", pl: "kontrola wersji" },
    { en: "code review", pl: "przeglƒÖd kodu" },
    { en: "deployment", pl: "wdro≈ºenie" },
    { en: "production environment", pl: "≈õrodowisko produkcyjne" },
    { en: "staging server", pl: "serwer testowy" },
    { en: "API endpoint", pl: "punkt ko≈Ñcowy API" },
    { en: "request / response", pl: "≈ºƒÖdanie / odpowied≈∫" },
    { en: "authentication", pl: "uwierzytelnianie" },
    { en: "authorization", pl: "autoryzacja" },
    { en: "frontend", pl: "warstwa frontowa (widoczna dla u≈ºytkownika)" },
    { en: "backend", pl: "warstwa serwerowa" },
    { en: "database", pl: "baza danych" },
    { en: "query", pl: "zapytanie (do bazy danych)" },
    { en: "error log", pl: "dziennik b≈Çƒôd√≥w" },
    { en: "runtime error", pl: "b≈ÇƒÖd w czasie dzia≈Çania" },
    { en: "debugging", pl: "usuwanie b≈Çƒôd√≥w" },
    { en: "performance", pl: "wydajno≈õƒá" },
    { en: "scalability", pl: "skalowalno≈õƒá" },
    { en: "feature", pl: "funkcjonalno≈õƒá" },
    { en: "release", pl: "wydanie wersji" },
    { en: "update", pl: "aktualizacja" },
    { en: "rollback", pl: "przywr√≥cenie poprzedniej wersji" },
    { en: "build pipeline", pl: "proces kompilacji" },
    { en: "continuous integration", pl: "ciƒÖg≈Ça integracja" },
    { en: "continuous delivery", pl: "ciƒÖg≈Çe wdra≈ºanie" },
    { en: "repository owner", pl: "w≈Ça≈õciciel repozytorium" },
    { en: "open source contribution", pl: "wk≈Çad w projekt open source" },
    { en: "documentation", pl: "dokumentacja" },
    { en: "issue tracker", pl: "system zg≈Çaszania b≈Çƒôd√≥w" },
    { en: "release notes", pl: "informacje o wersji" },
    { en: "unit test", pl: "test jednostkowy" },
    { en: "integration test", pl: "test integracyjny" },
    { en: "regression test", pl: "test regresyjny" },
    { en: "mock data", pl: "dane testowe" },
    { en: "error handling", pl: "obs≈Çuga b≈Çƒôd√≥w" },
    { en: "logging", pl: "rejestrowanie zdarze≈Ñ" },
    { en: "timeout", pl: "przekroczenie limitu czasu" },
    { en: "config file", pl: "plik konfiguracyjny" },
    { en: "syntax error", pl: "b≈ÇƒÖd sk≈Çadniowy" },

    // === COLLABORATION & TEAMWORK ===
    { en: "team meeting", pl: "spotkanie zespo≈Çu" },
    { en: "daily stand-up", pl: "codzienne spotkanie statusowe" },
    { en: "sprint", pl: "iteracja (w Agile)" },
    { en: "retrospective", pl: "spotkanie podsumowujƒÖce" },
    { en: "planning session", pl: "spotkanie planistyczne" },
    { en: "deadline", pl: "termin" },
    { en: "deliverable", pl: "element do dostarczenia" },
    { en: "task assignment", pl: "przydzielenie zadania" },
    { en: "feedback", pl: "informacja zwrotna" },
    { en: "brainstorming", pl: "burza m√≥zg√≥w" },
    { en: "collaboration", pl: "wsp√≥≈Çpraca" },
    { en: "communication", pl: "komunikacja" },
    { en: "responsibility", pl: "odpowiedzialno≈õƒá" },
    { en: "support", pl: "wsparcie" },
    { en: "remote work", pl: "praca zdalna" },
    { en: "workload", pl: "obciƒÖ≈ºenie pracƒÖ" },
    { en: "performance review", pl: "ocena wynik√≥w" },
    { en: "onboarding", pl: "wdro≈ºenie nowego pracownika" },
    { en: "mentor", pl: "mentor" },
    { en: "team lead", pl: "lider zespo≈Çu" },

    // === DEV.TO & BLOGGING ===
    { en: "Great post!", pl: "≈öwietny wpis!" },
    { en: "Thanks for sharing.", pl: "Dziƒôki za podzielenie siƒô." },
    { en: "This helped me a lot.", pl: "To bardzo mi pomog≈Ço." },
    { en: "I totally agree with you.", pl: "Ca≈Çkowicie siƒô z TobƒÖ zgadzam." },
    { en: "Could you explain it more clearly?", pl: "Czy mo≈ºesz to wyja≈õniƒá bardziej szczeg√≥≈Çowo?" },
    { en: "In this tutorial, we‚Äôll learn how to...", pl: "W tym poradniku nauczymy siƒô, jak..." },
    { en: "Let‚Äôs take a look at...", pl: "Przyjrzyjmy siƒô..." },
    { en: "Make sure you have installed...", pl: "Upewnij siƒô, ≈ºe masz zainstalowane..." },
    { en: "Run the following command:", pl: "Uruchom nastƒôpujƒÖcƒÖ komendƒô:" },
    { en: "Keep in mind that...", pl: "Pamiƒôtaj, ≈ºe..." },
    { en: "This project is built with...", pl: "Ten projekt zosta≈Ç zbudowany przy u≈ºyciu..." },
    { en: "Here‚Äôs how it works:", pl: "Oto, jak to dzia≈Ça:" },
    { en: "I recently built a small project using...", pl: "Niedawno stworzy≈Çem ma≈Çy projekt przy u≈ºyciu..." },
    { en: "This post covers the basics of...", pl: "Ten wpis omawia podstawy..." },
    { en: "You can customize it by editing...", pl: "Mo≈ºesz to dostosowaƒá, edytujƒÖc..." },
    { en: "In my experience,", pl: "Z mojego do≈õwiadczenia," },
    { en: "It‚Äôs important to note that...", pl: "Warto zauwa≈ºyƒá, ≈ºe..." },
    { en: "This approach is more efficient.", pl: "To podej≈õcie jest bardziej wydajne." },
    { en: "Let‚Äôs refactor our code.", pl: "Przebudujmy nasz kod." },
    { en: "Feel free to leave a comment.", pl: "≈ömia≈Ço, zostaw komentarz." },
    { en: "I‚Äôm open to feedback.", pl: "Jestem otwarty na opiniƒô." },
    { en: "Have you tried this method?", pl: "Czy pr√≥bowa≈Çe≈õ tej metody?" },
    { en: "I faced a similar issue last week.", pl: "Mia≈Çem podobny problem w zesz≈Çym tygodniu." },
    { en: "The community is really helpful.", pl: "Spo≈Çeczno≈õƒá jest naprawdƒô pomocna." },
    { en: "I hope this article helps someone.", pl: "Mam nadziejƒô, ≈ºe ten artyku≈Ç komu≈õ pomo≈ºe." },
    { en: "Let‚Äôs dive into the code.", pl: "Zanurzmy siƒô w kodzie." },
    { en: "Here‚Äôs my solution to this problem.", pl: "Oto moje rozwiƒÖzanie tego problemu." },
    { en: "I‚Äôll be happy to update the post later.", pl: "Chƒôtnie zaktualizujƒô wpis p√≥≈∫niej." },
    { en: "Feel free to correct me if I‚Äôm wrong.", pl: "Popraw mnie, je≈õli siƒô mylƒô." },

    // === DAILY COMMUNICATION ===
    { en: "How‚Äôs it going?", pl: "Jak leci?" },
    { en: "Good morning, team!", pl: "Dzie≈Ñ dobry, zespole!" },
    { en: "Let‚Äôs start the meeting.", pl: "Zacznijmy spotkanie." },
    { en: "Any updates from your side?", pl: "Jakie≈õ nowo≈õci z twojej strony?" },
    { en: "I‚Äôll take care of it.", pl: "Zajmƒô siƒô tym." },
    { en: "That sounds good to me.", pl: "Brzmi dobrze." },
    { en: "Let‚Äôs keep in touch.", pl: "Pozosta≈Ñmy w kontakcie." },
    { en: "Could you give me a hand?", pl: "Czy mo≈ºesz mi pom√≥c?" },
    { en: "No worries, I‚Äôve got this.", pl: "Spokojnie, ogarnƒô to." },
    { en: "Let‚Äôs double-check that.", pl: "Sprawd≈∫my to jeszcze raz." },
    { en: "We need to fix this ASAP.", pl: "Musimy to naprawiƒá jak najszybciej." },
    { en: "I‚Äôm running a bit late.", pl: "Trochƒô siƒô sp√≥≈∫niƒô." },
    { en: "Please share your screen.", pl: "Udostƒôpnij sw√≥j ekran." },
    { en: "I‚Äôll send you the link.", pl: "Wy≈õlƒô ci link." },
    { en: "Can you hear me?", pl: "S≈Çychaƒá mnie?" },
    { en: "Let‚Äôs take a five-minute break.", pl: "Zr√≥bmy piƒôƒá minut przerwy." },
    { en: "I‚Äôm available after lunch.", pl: "Jestem dostƒôpny po obiedzie." },
    { en: "I‚Äôll update the document.", pl: "Zaktualizujƒô dokument." },
    { en: "We‚Äôre almost done.", pl: "Prawie sko≈Ñczyli≈õmy." },

    // === TESTING & DEBUGGING ===
    { en: "bug", pl: "b≈ÇƒÖd" },
    { en: "fix", pl: "naprawiƒá" },
    { en: "broken feature", pl: "niedzia≈ÇajƒÖca funkcja" },
    { en: "error message", pl: "komunikat b≈Çƒôdu" },
    { en: "stack trace", pl: "≈õlad b≈Çƒôdu (stack trace)" },
    { en: "reproduce the issue", pl: "odtworzyƒá problem" },
    { en: "expected result", pl: "oczekiwany wynik" },
    { en: "actual result", pl: "rzeczywisty wynik" },
    { en: "bug report", pl: "raport b≈Çƒôdu" },
    { en: "severity", pl: "waga b≈Çƒôdu" },
    { en: "priority", pl: "priorytet" },
    { en: "steps to reproduce", pl: "kroki do odtworzenia" },
    { en: "regression testing", pl: "testy regresyjne" },
    { en: "unit test failed", pl: "test jednostkowy nie przeszed≈Ç" },
    { en: "please check the logs", pl: "sprawd≈∫ logi" },
    { en: "the app crashes on startup", pl: "aplikacja siƒô zawiesza przy uruchomieniu" },
    { en: "it works on my machine", pl: "u mnie dzia≈Ça" },
    { en: "run the debugger", pl: "uruchom debugger" },
    { en: "add a breakpoint", pl: "dodaj punkt przerwania" },
    { en: "the function returns null", pl: "funkcja zwraca null" },

    // === CAREER & MINDSET ===
    { en: "I‚Äôm learning every day.", pl: "Uczƒô siƒô ka≈ºdego dnia." },
    { en: "Practice makes perfect.", pl: "Trening czyni mistrza." },
    { en: "Never stop improving.", pl: "Nigdy nie przestawaj siƒô doskonaliƒá." },
    { en: "Keep pushing forward.", pl: "Id≈∫ dalej do przodu." },
    { en: "Mistakes help us grow.", pl: "B≈Çƒôdy pomagajƒÖ nam siƒô rozwijaƒá." },
    { en: "Stay curious.", pl: "BƒÖd≈∫ ciekawy ≈õwiata." },
    { en: "Share your knowledge.", pl: "Dziel siƒô wiedzƒÖ." },
    { en: "Learn from others.", pl: "Ucz siƒô od innych." },
    { en: "The best way to learn is to teach.", pl: "Najlepszym sposobem nauki jest nauczanie." },
    { en: "Focus on progress, not perfection.", pl: "Skup siƒô na postƒôpie, nie na perfekcji." },
    { en: "Ask for feedback.", pl: "Popro≈õ o opiniƒô." },
    { en: "Take small steps every day.", pl: "R√≥b ma≈Çe kroki ka≈ºdego dnia." },
    { en: "Coding is problem solving.", pl: "Programowanie to rozwiƒÖzywanie problem√≥w." },
    { en: "Teamwork makes the dream work.", pl: "Wsp√≥≈Çpraca czyni cuda." },
    { en: "Document your journey.", pl: "Dokumentuj swojƒÖ drogƒô." },
    { en: "Don‚Äôt be afraid to ask questions.", pl: "Nie b√≥j siƒô zadawaƒá pyta≈Ñ." },
    { en: "Be kind to beginners.", pl: "BƒÖd≈∫ ≈ºyczliwy dla poczƒÖtkujƒÖcych." },
    { en: "Every expert was once a beginner.", pl: "Ka≈ºdy ekspert by≈Ç kiedy≈õ poczƒÖtkujƒÖcym." },
    { en: "Celebrate small wins.", pl: "≈öwiƒôtuj ma≈Çe sukcesy." },
  ]
},

  toolshop_phrases: {
  icon: "‚öôÔ∏è",
  name: "Toolshop ‚Äî 300 Phrases & Expressions",
  desc: "Najczƒô≈õciej u≈ºywane zdania i zwroty w pracy mechanika narzƒôdziowego",
  words: [
    // === CODZIENNE ZWROTY W PRACY ===
    { en: "Good morning, team.", pl: "Dzie≈Ñ dobry, zespole." },
    { en: "Let‚Äôs start with the tool inspection.", pl: "Zacznijmy od przeglƒÖdu narzƒôdzia." },
    { en: "Please prepare the tool for disassembly.", pl: "Proszƒô przygotowaƒá narzƒôdzie do demonta≈ºu." },
    { en: "We have to check the press alignment.", pl: "Musimy sprawdziƒá ustawienie prasy." },
    { en: "This tool needs a full maintenance.", pl: "To narzƒôdzie wymaga pe≈Çnej konserwacji." },
    { en: "Can you bring the measurement report?", pl: "Mo≈ºesz przynie≈õƒá raport pomiarowy?" },
    { en: "The tool is ready for assembly.", pl: "Narzƒôdzie jest gotowe do monta≈ºu." },
    { en: "Let‚Äôs clean all parts before installation.", pl: "Wyczy≈õƒámy wszystkie czƒô≈õci przed monta≈ºem." },
    { en: "Be careful with the guide pins.", pl: "Uwa≈ºaj na ko≈Çki prowadzƒÖce." },
    { en: "The springs are under pressure.", pl: "Sprƒô≈ºyny sƒÖ pod napiƒôciem." },
    { en: "Check the punch holder alignment.", pl: "Sprawd≈∫ ustawienie p≈Çyty stemplowej." },
    { en: "Tighten all bolts to the correct torque.", pl: "Dokrƒôƒá wszystkie ≈õruby do odpowiedniego momentu." },
    { en: "We are missing a dowel pin.", pl: "Brakuje ko≈Çka ustalajƒÖcego." },
    { en: "The ejector is not working properly.", pl: "Wyrzutnik nie dzia≈Ça prawid≈Çowo." },
    { en: "Replace the damaged spring.", pl: "Wymie≈Ñ uszkodzonƒÖ sprƒô≈ºynƒô." },

    // === PRASA ‚Äî OBS≈ÅUGA I KOMUNIKACJA ===
    { en: "Start the press in manual mode.", pl: "Uruchom prasƒô w trybie rƒôcznym." },
    { en: "Set the stroke to 40 millimeters.", pl: "Ustaw skok na 40 milimetr√≥w." },
    { en: "The press cycle is too slow.", pl: "Cykl prasy jest zbyt wolny." },
    { en: "Check the oil level in the hydraulic unit.", pl: "Sprawd≈∫ poziom oleju w uk≈Çadzie hydraulicznym." },
    { en: "There is an error on the control panel.", pl: "Na panelu sterowania pojawi≈Ç siƒô b≈ÇƒÖd." },
    { en: "The slide movement is not smooth.", pl: "Ruch suwaka nie jest p≈Çynny." },
    { en: "Reset the safety system before continuing.", pl: "Zresetuj system bezpiecze≈Ñstwa przed kontynuacjƒÖ." },
    { en: "Press is ready for production.", pl: "Prasa jest gotowa do produkcji." },
    { en: "We need to adjust the press sensors.", pl: "Musimy wyregulowaƒá czujniki prasy." },
    { en: "The press is overheating.", pl: "Prasa siƒô przegrzewa." },
    { en: "Call maintenance for assistance.", pl: "Wezwij dzia≈Ç utrzymania ruchu." },

    // === KONSERWACJA / NAPRAWA ===
    { en: "The tool needs lubrication.", pl: "Narzƒôdzie wymaga nasmarowania." },
    { en: "Replace the worn inserts.", pl: "Wymie≈Ñ zu≈ºyte wk≈Çadki." },
    { en: "The guide pillar is bent.", pl: "S≈Çupek prowadzƒÖcy jest wygiƒôty." },
    { en: "Polish the surface of the punch.", pl: "Wypoleruj powierzchniƒô stempla." },
    { en: "The stripper plate must be cleaned.", pl: "P≈Çytƒô zdzieraka trzeba wyczy≈õciƒá." },
    { en: "Check for cracks on the die block.", pl: "Sprawd≈∫, czy nie ma pƒôkniƒôƒá w matrycy." },
    { en: "The top plate is worn out.", pl: "P≈Çyta g√≥rna jest zu≈ºyta." },
    { en: "We need to regrind the cutting edge.", pl: "Trzeba przeszlifowaƒá krawƒôd≈∫ tnƒÖcƒÖ." },
    { en: "Apply anti-corrosion spray.", pl: "Na≈Ç√≥≈º spray antykorozyjny." },
    { en: "Replace the broken pin.", pl: "Wymie≈Ñ z≈Çamany ko≈Çek." },
    { en: "Tighten the clamp screws.", pl: "Dokrƒôƒá ≈õruby mocujƒÖce." },
    { en: "Use a torque wrench for accuracy.", pl: "U≈ºyj klucza dynamometrycznego dla dok≈Çadno≈õci." },
    { en: "The ejector plate is stuck.", pl: "P≈Çyta wyrzutnika siƒô zaciƒô≈Ça." },
    { en: "The gas springs must be replaced.", pl: "Sprƒô≈ºyny gazowe trzeba wymieniƒá." },

    // === POMIARY I JAKO≈öƒÜ ===
    { en: "Check the flatness of the part.", pl: "Sprawd≈∫ p≈Çasko≈õƒá czƒô≈õci." },
    { en: "The dimension is out of tolerance.", pl: "Wymiar jest poza tolerancjƒÖ." },
    { en: "Measure the gap with a feeler gauge.", pl: "Zmierz luz szczelinomierzem." },
    { en: "The part is within specification.", pl: "Czƒô≈õƒá mie≈õci siƒô w specyfikacji." },
    { en: "Compare it with the drawing.", pl: "Por√≥wnaj to z rysunkiem." },
    { en: "The measurement protocol is complete.", pl: "Protok√≥≈Ç pomiarowy jest gotowy." },
    { en: "We need to recalibrate the micrometer.", pl: "Musimy skalibrowaƒá mikrometr." },
    { en: "Record the measurement results.", pl: "Zapisz wyniki pomiar√≥w." },
    { en: "This dimension must be corrected.", pl: "Ten wymiar trzeba poprawiƒá." },
    { en: "The tolerance range is ¬±0.02 mm.", pl: "Zakres tolerancji to ¬±0,02 mm." },
    { en: "The visual inspection looks fine.", pl: "Oglƒôdziny wizualne wyglƒÖdajƒÖ dobrze." },

    // === KOMUNIKACJA Z PRODUKCJƒÑ ===
    { en: "Production reported a problem with tool number 7.", pl: "Produkcja zg≈Çosi≈Ça problem z narzƒôdziem numer 7." },
    { en: "We need to stop the press immediately.", pl: "Musimy natychmiast zatrzymaƒá prasƒô." },
    { en: "The part is getting scratched during stamping.", pl: "Czƒô≈õƒá rysuje siƒô podczas t≈Çoczenia." },
    { en: "There‚Äôs too much burr on the edge.", pl: "Na krawƒôdzi jest zbyt du≈ºy grat." },
    { en: "The tool has to be adjusted.", pl: "Narzƒôdzie trzeba wyregulowaƒá." },
    { en: "We‚Äôll make a test stroke.", pl: "Zrobimy pr√≥bny skok." },
    { en: "The operator noticed a strange noise.", pl: "Operator zauwa≈ºy≈Ç dziwny ha≈Ças." },
    { en: "Engineering will support us with analysis.", pl: "In≈ºynieria pomo≈ºe nam w analizie." },
    { en: "The issue is under investigation.", pl: "Problem jest w trakcie analizy." },
    { en: "Let‚Äôs check the press sensors.", pl: "Sprawd≈∫my czujniki prasy." },
    { en: "After the adjustment, it works correctly.", pl: "Po regulacji dzia≈Ça prawid≈Çowo." },

    // === DIAGNOSTYKA I AWARIE ===
    { en: "We have a hydraulic leak.", pl: "Mamy wyciek hydrauliczny." },
    { en: "The air pressure dropped suddenly.", pl: "Ci≈õnienie powietrza nagle spad≈Ço." },
    { en: "There‚Äôs an alarm on the control screen.", pl: "Na ekranie sterowania pojawi≈Ç siƒô alarm." },
    { en: "The tool jammed during the press cycle.", pl: "Narzƒôdzie zablokowa≈Ço siƒô podczas cyklu prasy." },
    { en: "A sensor is not responding.", pl: "Czujnik nie reaguje." },
    { en: "Let‚Äôs check the electrical cabinet.", pl: "Sprawd≈∫my szafƒô elektrycznƒÖ." },
    { en: "The temperature is too high.", pl: "Temperatura jest zbyt wysoka." },
    { en: "The press must be stopped for safety.", pl: "Prasa musi zostaƒá zatrzymana ze wzglƒôd√≥w bezpiecze≈Ñstwa." },
    { en: "We replaced the defective valve.", pl: "Wymienili≈õmy wadliwy zaw√≥r." },
    { en: "The tool is running again.", pl: "Narzƒôdzie zn√≥w pracuje." },

    // === ORGANIZACJA I RAPORTY ===
    { en: "The maintenance report is done.", pl: "Raport z konserwacji jest gotowy." },
    { en: "Please update the tool history.", pl: "Zaktualizuj historiƒô narzƒôdzia." },
    { en: "Add the inspection date to the logbook.", pl: "Dodaj datƒô przeglƒÖdu do dziennika." },
    { en: "The replacement parts are ordered.", pl: "Czƒô≈õci zamienne zosta≈Çy zam√≥wione." },
    { en: "The tool is waiting for grinding.", pl: "Narzƒôdzie czeka na szlifowanie." },
    { en: "We‚Äôll send the tool to external service.", pl: "Wy≈õlemy narzƒôdzie do serwisu zewnƒôtrznego." },
    { en: "Production can restart after confirmation.", pl: "Produkcja mo≈ºe ruszyƒá po potwierdzeniu." },
    { en: "Everything is documented in the report.", pl: "Wszystko jest udokumentowane w raporcie." },
    { en: "Next inspection is planned for Friday.", pl: "Kolejny przeglƒÖd zaplanowany na piƒÖtek." },
  ],

    
},


};

/* ===================== USTAWIENIA/STATE ===================== */
const THEME_KEY="led_theme_v2";
const pkgSelect = document.getElementById('package');
const dirSel = document.getElementById('direction');
let current = localStorage.getItem("led_pkg_key") || "devto_general";
let direction = localStorage.getItem("led_direction") || "EN2PL";
let mode = "flash"; // flash|quiz|stats

function k(s){return `led_${current}_${s}`;}

function loadAll(){
  const savedWords = JSON.parse(localStorage.getItem(k("words"))||"null");
  const words = savedWords?.length ? savedWords : packages[current].words.map(w=>({...w,known:false}));
  const stats = JSON.parse(localStorage.getItem(k("stats"))||"{}");
  const history = JSON.parse(localStorage.getItem(k("history"))||"[]"); // [{ts,mode,correct,total,secs}]
  localStorage.setItem(k("words"),JSON.stringify(words));
  return {words,stats,history};
}
function saveAll(){ localStorage.setItem(k("words"),JSON.stringify(words)); localStorage.setItem(k("stats"),JSON.stringify(stats)); localStorage.setItem(k("history"),JSON.stringify(history)); }

let {words,stats,history} = loadAll();
let cursor = 0;

/* ===================== UI: motyw, pakiety, tagi ===================== */
(function initTheme(){
  const t = localStorage.getItem(THEME_KEY)||"dark";
  document.body.classList.toggle("light", t==="light");
  document.getElementById('t-light').checked = t==="light";
  document.getElementById('t-dark').checked  = t!=="light";
  document.getElementById('t-light').addEventListener('change',()=>{localStorage.setItem(THEME_KEY,"light");document.body.classList.add("light");});
  document.getElementById('t-dark').addEventListener('change',()=>{localStorage.setItem(THEME_KEY,"dark");document.body.classList.remove("light");});
})();

(function initPackages(){
  pkgSelect.innerHTML = "";
  for(const [key,p] of Object.entries(packages)){
    const opt = document.createElement('option');
    opt.value = key;
    opt.textContent = `${p.icon} ${p.name} ‚Äî ${p.desc}`;
    if(key===current) opt.selected = true;
    pkgSelect.appendChild(opt);
  }
  pkgSelect.addEventListener('change', ()=>{
    current = pkgSelect.value;
    localStorage.setItem("led_pkg_key", current);
    const all = loadAll(); words=all.words; stats=all.stats; history=all.history; cursor=0;
    renderTags(); renderList(); updateKPI(); renderDailySpark(); showFlash();
  });
})();

function uniqueTags(){ return [...new Set(words.map(w=>w.tag))]; }
function renderTags(){
  const tags = uniqueTags();
  const box = document.getElementById('tags');
  box.innerHTML = `<div class="small">Filtr tag√≥w:</div>` + ['*',...tags].map(t=>`<button class="tab" data-tag="${t}">${t==='*'?'Wszystkie':t}</button>`).join(' ');
}
function renderList(filter=null){
  const list = document.getElementById('list');
  const items = words
    .filter(w=>!filter || filter==='*' || w.tag===filter)
    .sort((a,b)=> a.en.localeCompare(b.en));
  list.innerHTML = items.map((w,i)=>`<div class="tag ${w.known?'known':''}" data-idx="${i}">${w.en} ‚Äî ${w.pl}</div>`).join('');
}

/* ===================== KPI + Statystyki dzienne (spark) ===================== */
function updateKPI(){
  const known = words.filter(w=>w.known).length;
  document.getElementById('k-known').textContent = known;
  document.getElementById('k-left').textContent  = words.length - known;
  const acc = stats.correct && stats.total ? Math.round(100*stats.correct/stats.total) : 0;
  document.getElementById('k-acc').textContent   = acc + "%";
  document.getElementById('k-week').textContent  = sessionsLastDays(7).length;
}
function dayKey(d=new Date()){return d.toISOString().slice(0,10);}
function sessionsLastDays(n){
  const out = []; const now = new Date();
  for(let i=0;i<n;i++){
    const d = new Date(now); d.setDate(now.getDate()-i);
    const k = d.toISOString().slice(0,10);
    const day = history.filter(h=>h.day===k);
    out.push({day:k,count:day.length});
  }
  return out.reverse();
}
function renderDailySpark(){
  const spark = document.getElementById('spark'); spark.innerHTML="";
  const arr = sessionsLastDays(7);
  const max = Math.max(1,...arr.map(a=>a.count));
  for(const a of arr){
    const bar = document.createElement('div');
    bar.className='bar';
    bar.style.height = (a.count/max*100)+'%';
    bar.title = `${a.day}: ${a.count} sesji`;
    spark.appendChild(bar);
  }
}

/* ===================== FISZKI ===================== */
function setDirection(dir){ direction=dir; localStorage.setItem("led_direction",dir); if(mode==='flash') renderCard(); }
function poolUnknown(){ return words.filter(w=>!w.known); }
function nextIndex(){
  const pool = mode==='flash' ? poolUnknown() : words;
  if(pool.length===0) return -1;
  const idx = Math.floor(Math.random()*pool.length);
  // mapujemy na indeks globalny
  return words.indexOf(pool[idx]);
}
function promptText(w){
  if(direction==="PL2EN") return w.pl;
  if(direction==="MIX") return Math.random()<0.5?w.en:w.pl;
  return w.en;
}
function answerText(w,prompt){ return (prompt===w.en)? w.pl : w.en; }

function renderCard(){
  if(cursor<0 || !words.length){ 
    document.getElementById('card-word').textContent="‚Äî"; 
    document.getElementById('card-translation').innerHTML="&nbsp;";
    document.getElementById('card-example').innerHTML="&nbsp;";
    return;
  }
  const w = words[cursor];
  const prompt = promptText(w);
  document.getElementById('card-word').textContent = prompt;
  document.getElementById('card-translation').innerHTML="&nbsp;";
  const ex = w.exEN && w.exPL ? (direction==="PL2EN" ? `${w.exPL} ‚Üí ${w.exEN}` : `${w.exEN} ‚Üí ${w.exPL}`) :
            (w.tag==="sentences" ? "ƒÜwicz ca≈Çe zdanie ‚Äî zwr√≥ƒá uwagƒô na szyk." : "Brak przyk≈Çadowego zdania.");
  document.getElementById('card-example').textContent = ex;
}

function showFlash(){
  mode='flash';
  document.getElementById('view-flash').style.display='';
  document.getElementById('view-quiz').style.display='none';
  document.getElementById('view-stats').style.display='none';
  document.getElementById('tab-flash').classList.add('active');
  document.getElementById('tab-quiz').classList.remove('active');
  document.getElementById('tab-stats').classList.remove('active');
  cursor = nextIndex();
  renderCard();
}

/* ===================== QUIZ ABCD ===================== */
let quizState=null; // {q:{}, options:[], correct, answered}
function makeQuestion(){
  const q = words[Math.floor(Math.random()*words.length)];
  const prompt = Math.random()<0.5 ? q.en : q.pl;
  const correct = (prompt===q.en)? q.pl : q.en;
  const wrongs = words.filter(w=>w!==q).sort(()=>Math.random()-0.5).slice(0,3)
                      .map(w => (prompt===q.en? w.pl : w.en));
  const options = [correct, ...wrongs].sort(()=>Math.random()-0.5);
  return {q,prompt,options,correct};
}
function showQuiz(){
  mode='quiz';
  document.getElementById('view-flash').style.display='none';
  document.getElementById('view-quiz').style.display='';
  document.getElementById('view-stats').style.display='none';
  document.getElementById('tab-flash').classList.remove('active');
  document.getElementById('tab-quiz').classList.add('active');
  document.getElementById('tab-stats').classList.remove('active');
  ask();
}
function ask(seriesLeft=null){
  quizState = makeQuestion();
  document.getElementById('quiz-q').textContent = (quizState.prompt===quizState.q.en)
    ? `Co znaczy: ‚Äú${quizState.q.en}‚Äù?` : `Jak po angielsku: ‚Äú${quizState.q.pl}‚Äù?`;
  const box = document.getElementById('quiz-choices'); box.innerHTML="";
  document.getElementById('quiz-feedback').textContent="";
  quizState.options.forEach(text=>{
    const div = document.createElement('div'); div.className='choice'; div.textContent=text;
    div.onclick = ()=>{
      stats.total = (stats.total||0)+1;
      const ok = text===quizState.correct;
      if(ok){ stats.correct = (stats.correct||0)+1; div.classList.add('correct'); }
      else { div.classList.add('wrong'); document.getElementById('quiz-feedback').textContent=`Poprawnie: ${quizState.correct}`; }
      saveAll(); updateKPI();
    };
    box.appendChild(div);
  });
  document.getElementById('quiz-progress').textContent = seriesLeft!=null ? `Seria: pozosta≈Ço ${seriesLeft}` : '';
}
function runSeries(n){
  let left = n;
  const step = ()=>{
    if(left<=0){
      pushHistory('quiz', n, n, 0); // zapis og√≥lny serii (szczeg√≥≈Çy ju≈º w stats)
      renderStatsView();
      return;
    }
    ask(left);
    left--;
    // automatyczne przej≈õcie po odpowiedzi u≈ºytkownika: zostawiamy przycisk "Nastƒôpne pytanie"
  };
  step();
  document.getElementById('quiz-next').onclick = step;
}

/* ===================== HISTORIA / STATYSTYKI ===================== */
function pushHistory(mode, correct, total, secs){
  const rec = {mode, correct, total, secs, day:dayKey(), ts:Date.now()};
  history.unshift(rec);
  history = history.slice(0, 100); // limit
  saveAll();
}
function renderStatsView(){
  mode='stats';
  document.getElementById('view-flash').style.display='none';
  document.getElementById('view-quiz').style.display='none';
  document.getElementById('view-stats').style.display='';
  document.getElementById('tab-flash').classList.remove('active');
  document.getElementById('tab-quiz').classList.remove('active');
  document.getElementById('tab-stats').classList.add('active');

  const acc = stats.total ? Math.round(100* (stats.correct||0) / stats.total) : 0;
  const known = words.filter(w=>w.known).length;
  const html = `
    <div>üì¶ Pakiet: <strong>${packages[current].name}</strong> ‚Äî ${packages[current].desc}</div>
    <div>üìä Skuteczno≈õƒá: <strong class="${acc>=70?'goodtxt':'badtxt'}">${acc}%</strong> ( ${stats.correct||0} / ${stats.total||0} )</div>
    <div>üß† Nauczone s≈Çowa: <strong>${known}</strong> / ${words.length}</div>
  `;
  document.getElementById('stats-summary').innerHTML = html;

  // spark
  renderDailySpark();

  // historia
  const histBox = document.getElementById('history');
  if(!history.length){ histBox.innerHTML = `<div class="small">Brak historii w tym pakiecie.</div>`; }
  else{
    const rows = history.slice(0,30).map(h=>{
      const a = Math.round(h.total? 100*h.correct/h.total : 0);
      const date = new Date(h.ts).toLocaleString();
      return `<div class="tag">[${date}] ${h.mode.toUpperCase()} ‚Äî wynik: ${h.correct}/${h.total} (${a}%)</div>`;
    }).join('');
    histBox.innerHTML = rows;
  }
}

/* ===================== ZDARZENIA ===================== */
document.getElementById('tab-flash').onclick = showFlash;
document.getElementById('tab-quiz').onclick  = showQuiz;
document.getElementById('tab-stats').onclick = renderStatsView;

document.getElementById('shuffle').onclick = ()=>{ words.sort(()=>Math.random()-0.5); saveAll(); renderList(); if(mode==='flash') renderCard(); };
document.getElementById('reset').onclick   = ()=>{
  if(confirm("Zerowaƒá status nauki i statystyki bie≈ºƒÖcego pakietu?")){
    words = packages[current].words.map(w=>({...w,known:false}));
    stats = {}; history = [];
    saveAll(); renderList(); updateKPI(); renderDailySpark(); if(mode==='flash') showFlash(); else renderStatsView();
  }
};

document.getElementById('direction').value = direction;
document.getElementById('direction').addEventListener('change', e=> setDirection(e.target.value));

document.getElementById('show').onclick = ()=>{
  const w = words[cursor]; if(!w) return;
  const prompt = document.getElementById('card-word').textContent;
  document.getElementById('card-translation').textContent = answerText(w, prompt);
};

document.getElementById('hint').onclick = ()=>{
  const w = words[cursor]; if(!w) return;
  const ex = w.exEN && w.exPL ? (direction==="PL2EN" ? `${w.exPL} ‚Üí ${w.exEN}` : `${w.exEN} ‚Üí ${w.exPL}`) :
            (w.tag==="sentences" ? "ƒÜwicz ca≈Çe zdanie ‚Äî zwr√≥ƒá uwagƒô na szyk." : "Brak przyk≈Çadowego zdania.");
  document.getElementById('card-example').textContent = ex;
};

document.getElementById('know').onclick = ()=>{
  const w = words[cursor]; if(!w) return;
  w.known = true; saveAll(); updateKPI();
  cursor = nextIndex(); if(cursor<0){ document.getElementById('card-word').textContent="üéâ Wszystko nauczone!"; document.getElementById('card-translation').textContent=""; return; }
  renderCard();
};

document.getElementById('next').onclick = ()=>{
  cursor = nextIndex(); if(cursor<0){ document.getElementById('card-word').textContent="üéâ Wszystko nauczone!"; document.getElementById('card-translation').textContent=""; return; }
  renderCard();
};

document.getElementById('quiz-next').onclick = ()=> ask();
document.getElementById('quiz-10').onclick = ()=> runSeries(10);
document.getElementById('quiz-20').onclick = ()=> runSeries(20);

document.getElementById('tags').addEventListener('click', (e)=>{
  const t = e.target?.dataset?.tag; if(!t) return;
  renderList(t);
});

document.getElementById('list').addEventListener('click', (e)=>{
  const el = e.target.closest('.tag'); if(!el) return;
  const i = +el.dataset.idx; if(Number.isNaN(i)) return;
  words[i].known = !words[i].known; saveAll(); renderList(); updateKPI();
});

/* ===================== START ===================== */
(function start(){
  // domy≈õlny motyw
  const t = localStorage.getItem(THEME_KEY)||"dark";
  document.getElementById('t-light').checked = t==="light";
  document.getElementById('t-dark').checked  = t!=="light";
  // KPI/lista/tags
  renderTags(); renderList(); updateKPI(); renderDailySpark();
  // tryb startowy
  showFlash();
})();
</script>
</body>
</html>
